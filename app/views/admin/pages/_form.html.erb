<%= form_for([:admin, @site, @page || @site.pages.new]) do |f| %>

  <div class="field">
    <%= f.label :title %>
    <%= f.text_field :title, :class=>"long #{'error' if !@page.errors[:title].empty? && action_name != 'new'}" %>
    <%= errors_for @page, :title %>
  </div>

  <div class="field">
    <%= f.label :body %>
    <%= f.text_area :body %>
  </div>

  <div class="field">
    <%= f.label :permalink %>
    <%= f.text_field :permalink, :class=>"long #{'error' if !@page.errors[:permalink].empty? && action_name != 'new'}" %>
    <%= errors_for @page, :permalink %>
  </div>

  <div class="field">
    <%= f.label :highlighted %>
    <%= f.check_box :highlighted %>
  </div>

  <div class="field">
    <%= f.label :parent_id, 'Parent page' %>
    <%= f.select :parent_id, (Page.parents - [@page]).collect{ |p| [p.title, p.id] }, :prompt => 'Select a parent page' %>
  </div>

  <%= f.submit 'Save', :class => "#{'error' if @page.invalid? && action_name != 'new'}" %>

<% end -%>